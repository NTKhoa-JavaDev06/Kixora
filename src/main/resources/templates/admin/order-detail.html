<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>KIXORA - Chi tiết đơn hàng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --admin-green: #2ecc71; --dark-bg: #2c3e50; }
        body { background: #f4f7f6; font-family: 'Segoe UI', sans-serif; }
        .main-content { padding: 40px; }
        .card { border: none; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    </style>
</head>
<body>
<div th:replace="~{navigation :: header}"></div>

<div class="main-content container">
    <div class="d-flex justify-content-between align-items-start mb-4">
        <div>
            <h2 class="fw-bold text-dark mb-1">Đơn hàng #<span th:text="${order.id}"></span></h2>
            <p class="text-muted">
                <i class="far fa-calendar-alt me-1"></i> Ngày đặt:
                <span th:if="${order.orderDate != null}"
                      th:text="${order.orderDate.dayOfMonth + '/' + order.orderDate.monthValue + '/' + order.orderDate.year}"></span>
                <span th:unless="${order.orderDate != null}">N/A</span>
            </p>
        </div>
        <div class="text-end">
            <a th:href="@{/admin/orders}" class="btn btn-outline-secondary rounded-pill shadow-sm">
                <i class="fas fa-arrow-left me-2"></i> Quay lại
            </a>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-4">
            <div class="card p-4 mb-4">
                <h5 class="fw-bold mb-3 text-success"><i class="fas fa-info-circle me-2"></i>Thông tin đơn</h5>
                <p class="mb-1 text-muted small">Trạng thái đơn hàng:</p>
                <p class="fw-bold text-primary" th:text="${order.status}">Pending</p>

                <hr>

                <p class="mb-1 text-muted small">Khách hàng ID:</p>
                <p class="fw-bold" th:text="${order.userId}"></p>

                <hr>

                <p class="mb-1 text-muted small">Địa chỉ nhận hàng:</p>
                <p class="fw-bold" th:text="${order.shippingAddress != null ? order.shippingAddress : 'N/A'}"></p>

                <hr>

                <p class="mb-1 text-muted small">Thanh toán:</p>
                <span class="badge rounded-pill"
                      th:classappend="${order.paymentStatus == 'Paid' ? 'bg-success' : 'bg-danger'}"
                      th:text="${order.paymentStatus}"></span>
            </div>
        </div>

        <div class="col-md-8">
            <div class="card p-4">
                <h5 class="fw-bold mb-4"><i class="fas fa-shopping-bag me-2"></i>Sản phẩm</h5>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                        <tr>
                            <th>Sản phẩm</th>
                            <th class="text-center">SL</th>
                            <th class="text-end">Đơn giá</th>
                            <th class="text-end">Thành tiền</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="d : ${details}">
                            <td>
                                <div class="fw-bold text-primary" th:text="'Biến thể #' + ${d.productVariantId}"></div>
                                <small class="text-muted" th:text="'Mã chi tiết: ' + ${d.id}"></small>
                            </td>
                            <td class="text-center" th:text="${d.quantity}">1</td>
                            <td class="text-end" th:text="${#numbers.formatDecimal(d.unitPrice, 0, 'POINT', 0, 'COMMA')} + '₫'"></td>
                            <td class="text-end fw-bold text-success" th:text="${#numbers.formatDecimal(d.unitPrice * d.quantity, 0, 'POINT', 0, 'COMMA')} + '₫'"></td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td colspan="3" class="text-end fw-bold">Tổng cộng:</td>
                            <td class="text-end fw-bold text-danger fs-5"
                                th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'POINT', 0, 'COMMA')} + '₫'"></td>
                        </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>